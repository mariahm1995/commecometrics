% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/reconstruct_env_qual.R
\name{reconstruct_env_qual}
\alias{reconstruct_env_qual}
\title{Reconstruct Past Qualitative Environmental Categories Using Ecometric Trait Bins}
\usage{
reconstruct_env_qual(
  fossildata,
  model_out,
  match_nearest = TRUE,
  fossil_lon = NULL,
  fossil_lat = NULL,
  modern_id = NULL,
  modern_lon = NULL,
  modern_lat = NULL,
  crs_proj = 4326
)
}
\arguments{
\item{fossildata}{A data frame containing fossil trait summaries (must include columns \code{Mean} and \code{SD}).}

\item{model_out}{Output from \code{ecometric_model_qualitative()}.}

\item{match_nearest}{Logical; if TRUE, matches each fossil to the nearest modern point (default = TRUE).}

\item{fossil_lon}{Name of the longitude column in \code{fossildata}. Required if \code{match_nearest = TRUE}.}

\item{fossil_lat}{Name of the latitude column in \code{fossildata}. Required if \code{match_nearest = TRUE}.}

\item{modern_id}{Name of the unique ID column in modern points (optional for metadata merging).}

\item{modern_lon}{Name of the longitude column in modern points. Required if \code{match_nearest = TRUE}.}

\item{modern_lat}{Name of the latitude column in modern points. Required if \code{match_nearest = TRUE}.}

\item{crs_proj}{Coordinate reference system for sf operations (default = EPSG:4326).}
}
\value{
A data frame (\code{fossildata}) updated with:
\itemize{
\item Fossil bin assignments (fossil_mbc, fossil_sdc).
\item Predicted environmental category (fossil_env_est).
\item Probabilities for each category (fossil_prob_*).
\item Nearest modern site metadata (optional).
}
}
\description{
This function uses fossil community trait summaries (mean and SD) to reconstruct
the most probable environmental category by projecting them onto a qualitative ecometric space
built from modern data. Optionally, it assigns each fossil point to the nearest modern sampling point.
}
