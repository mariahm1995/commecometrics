% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/reconstruct_env.R
\name{reconstruct_env}
\alias{reconstruct_env}
\title{Reconstruct Past Environmental Conditions Using Ecometric Trait Bins}
\usage{
reconstruct_env(
  fossildata,
  model_out,
  inv_transform = NULL,
  ci = 0.05,
  match_nearest = TRUE,
  fossil_lon = NULL,
  fossil_lat = NULL,
  modern_id = NULL,
  modern_lon = NULL,
  modern_lat = NULL,
  crs_proj = 4326
)
}
\arguments{
\item{fossildata}{A data frame containing fossil trait summaries per time bin.
Must include columns for \code{Mean} and \code{SD} of the trait.}

\item{model_out}{Output list from \code{run_ecometric_model()}, containing modern data, diagnostics, and model settings.}

\item{inv_transform}{A function to back-transform environmental estimates to the original scale.
Default is \code{exp(x) - 1}. If \code{NULL}, the inverse transform stored in \code{model_out} is used if available.}

\item{ci}{The width of the interval to calculate around the maximum likelihood estimate (default = 0.05).}

\item{match_nearest}{Logical; if TRUE, the function matches each fossil to its nearest modern point based on coordinates (default = TRUE).}

\item{fossil_lon}{Name of the longitude column in \code{fossildata}. Required if \code{match_nearest = TRUE}.}

\item{fossil_lat}{Name of the latitude column in \code{fossildata}. Required if \code{match_nearest = TRUE}.}

\item{modern_id}{Name of the unique identifier column in modern points (e.g., "GlobalID").}

\item{modern_lon}{Name of the longitude column in modern points. Required if \code{match_nearest = TRUE}.}

\item{modern_lat}{Name of the latitude column in modern points. Required if \code{match_nearest = TRUE}.}

\item{crs_proj}{Coordinate reference system to use when converting fossil and modern data to sf format (default = EPSG:4326).}
}
\value{
A data frame (\code{fossildata}) updated with fossil-specific environmental estimates and optionally nearest modern site information.
}
\description{
This function uses fossil community trait summaries (mean and SD) to reconstruct
past environmental conditions by projecting them onto a binned ecometric trait space
built from modern data. Optionally, it also assigns each fossil point to the nearest
modern sampling site to retrieve observed environmental data.
}
\details{
\itemize{
\item Fossil trait values must be pre-aggregated at the desired time scale (e.g., per fossil locality or assemblage).
\item The method uses kernel density estimation to predict the most likely environmental condition for each fossil community.
\item Confidence intervals are calculated as a fixed-width window around the maximum likelihood value.
\item When matching fossils to modern sites, geographic coordinates must be provided and both datasets are internally reprojected to \code{crs_proj}.
}
}
